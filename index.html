<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>T.B Agar.io</title>
<style>
body, html {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: #222;
    overflow: hidden;
    color: #fff;
}
#startScreen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #222;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
#startScreen h1 { font-size: 3em; margin-bottom: 20px; }
#startScreen input { padding: 10px; font-size: 1.2em; margin-bottom: 10px; }
#startScreen button { padding: 10px 20px; font-size: 1.2em; cursor: pointer; background-color: #0f0; border: none; border-radius: 5px; }
canvas { display: block; }
#uiButtons { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); }
#uiButtons button { padding: 10px 20px; margin: 0 10px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; }
#leaderboard { position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 5px; }
</style>
</head>
<body>

<div id="startScreen">
    <h1>T.B Agar.io</h1>
    <input type="text" id="playerName" placeholder="Voer je naam in">
    <button onclick="startGame()">Start Game</button>
</div>

<div id="uiButtons" style="display:none;">
    <button onclick="splitPlayer()">Split</button>
    <button onclick="feedPlayer()">Feed</button>
</div>

<div id="leaderboard" style="display:none;">
    <h3>Leaderboard</h3>
    <ol id="leaders"></ol>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Game state
let gameRunning = false;
let keys = {};
let player;
let foods = [];
let bots = [];
const foodCount = 50;
const botCount = 5;

// Utils
function getRandomColor() {
    const colors = ['#FF4136','#FF851B','#2ECC40','#0074D9','#B10DC9','#FFDC00'];
    return colors[Math.floor(Math.random()*colors.length)];
}
function distance(a,b) { return Math.hypot(a.x-b.x, a.y-b.y); }

// Player & Bot
function createPlayer(name) {
    return { x: canvas.width/2, y: canvas.height/2, radius: 20, color: getRandomColor(), name: name, vx:0, vy:0 };
}
function createBot(name) {
    return { x: Math.random()*canvas.width, y: Math.random()*canvas.height, radius: 20, color: getRandomColor(), name: name, vx:0, vy:0 };
}

// Food
function createFood() {
    foods = [];
    for(let i=0;i<foodCount;i++){
        foods.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, radius:5, color:getRandomColor()});
    }
}

// Movement
function movePlayer() {
    const speed = 5;
    if(keys['ArrowUp']||keys['w']) player.y -= speed;
    if(keys['ArrowDown']||keys['s']) player.y += speed;
    if(keys['ArrowLeft']||keys['a']) player.x -= speed;
    if(keys['ArrowRight']||keys['d']) player.x += speed;
    // keep in canvas
    player.x = Math.max(player.radius, Math.min(canvas.width-player.radius, player.x));
    player.y = Math.max(player.radius, Math.min(canvas.height-player.radius, player.y));
}

function moveBots() {
    for(let bot of bots){
        if(Math.random()<0.02) {
            bot.vx = (Math.random()-0.5)*2;
            bot.vy = (Math.random()-0.5)*2;
        }
        bot.x += bot.vx;
        bot.y += bot.vy;
        bot.x = Math.max(bot.radius, Math.min(canvas.width-bot.radius, bot.x));
        bot.y = Math.max(bot.radius, Math.min(canvas.height-bot.radius, bot.y));
    }
}

// Eating
function eat(playerObj) {
    for(let i=foods.length-1;i>=0;i--){
        let f=foods[i];
        if(distance(playerObj,f)<playerObj.radius+f.radius){
            foods.splice(i,1);
            playerObj.radius += 0.5;
        }
    }
}

// Split & Feed
function splitPlayer() {
    player.radius = Math.max(10, player.radius/2);
}
function feedPlayer() {
    player.radius = Math.max(10, player.radius-2);
    foods.push({x:player.x+Math.random()*20-10, y:player.y+Math.random()*20-10, radius:5, color:getRandomColor()});
}

// Draw
function drawPlayer(p) {
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.radius, 0, Math.PI*2);
    ctx.fillStyle = p.color;
    ctx.fill();
    ctx.closePath();
    ctx.fillStyle="#fff";
    ctx.font=`${Math.max(p.radius/2,12)}px Arial`;
    ctx.textAlign="center";
    ctx.fillText(p.name,p.x,p.y+4);
}
function drawFood() { for(let f of foods){ ctx.beginPath(); ctx.arc(f.x,f.y,f.radius,0,Math.PI*2); ctx.fillStyle=f.color; ctx.fill(); ctx.closePath(); } }
function drawLeaderboard() {
    let allPlayers = [player,...bots];
    allPlayers.sort((a,b)=>b.radius-a.radius);
    const leaders = document.getElementById('leaders');
    leaders.innerHTML = '';
    allPlayers.slice(0,5).forEach(p=>{
        const li = document.createElement('li');
        li.textContent = `${p.name} (${Math.floor(p.radius)})`;
        leaders.appendChild(li);
    });
}

// Game loop
function gameLoop() {
    if(!gameRunning) return;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    movePlayer();
    moveBots();
    eat(player);
    bots.forEach(b=>eat(b));
    drawFood();
    drawPlayer(player);
    bots.forEach(drawPlayer);
    drawLeaderboard();
    // Respawn food
    if(foods.length<foodCount) createFood();
    requestAnimationFrame(gameLoop);
}

// Start game
function startGame() {
    const name = document.getElementById('playerName').value;
    if(!name){ alert('Voer een naam in!'); return; }
    player = createPlayer(name);
    bots = [];
    for(let i=0;i<botCount;i++) bots.push(createBot('Bot'+(i+1)));
    createFood();
    document.getElementById('startScreen').style.display='none';
    document.getElementById('uiButtons').style.display='block';
    document.getElementById('leaderboard').style.display='block';
    gameRunning=true;
    gameLoop();
}

// Input
window.addEventListener('keydown',(e)=>keys[e.key]=true);
window.addEventListener('keyup',(e)=>keys[e.key]=false);
window.addEventListener('resize',()=>{ canvas.width=window.innerWidth; canvas.height=window.innerHeight; });
</script>

</body>
</html>

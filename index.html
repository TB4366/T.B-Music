<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Bedrijfs Radio Station</title>
<style>
 body { font-family: Arial; padding: 20px; background:#111; color:#fff; }
 h2{color:#4ff;} button{padding:10px;margin:5px;border:0;background:#4ff;color:#000;font-weight:bold;cursor:pointer;border-radius:8px;} 
 .block{background:#222;padding:15px;border-radius:10px;margin:15px 0;}
 .list-item{background:#333;padding:8px;border-radius:6px;margin:6px 0;}
</style>
</head>
<body>
<h2>üìª Bedrijfs Radio Station</h2>
<p>Automatische muziek + reclames + non-stop afspeelmodus.</p>

<div class="block">
 <h3>Muziek Uploaden</h3>
 <input type="file" id="musicUpload" accept="audio/*" multiple>
 <button onclick="uploadMusic()">Upload</button>
 <div id="musicList"></div>
</div>

<div class="block">
 <h3>Reclames Uploaden</h3>
 <input type="file" id="adUpload" accept="audio/*" multiple>
 <button onclick="uploadAd()">Upload Reclame</button>
 <p>Aantal reclames: <span id="adCount">0</span></p>
 <div id="adList"></div>
</div>

<div class="block">
 <h3>Instellingen</h3>
 <label>Nummers v√≥√≥r een reclame:</label>
 <input type="number" id="interval" value="3" min="1" max="10"><br><br>
 <label>Reclames achter elkaar:</label>
 <input type="number" id="chain" value="1" min="1" max="5"><br><br>
 <button onclick="saveConfig()">Instellingen Opslaan</button>
</div>

<div class="block">
 <h3>Radio Bediening</h3>
 <button onclick="startRadio()">‚ñ∂ Start Radio</button>
 <button onclick="stopRadio()">‚èπ Stop</button>
 <button onclick="nextSong()">‚è≠ Volgende</button>
</div>

<audio id="player" controls style="width:100%;margin-top:20px;"></audio>

<script>
let music = JSON.parse(localStorage.getItem('radio_music')||'[]');
let ads = JSON.parse(localStorage.getItem('radio_ads')||'[]');
let interval = Number(localStorage.getItem('radio_interval')||3);
let chain = Number(localStorage.getItem('radio_chain')||1);
let index = 0;
let playCount = 0;
let playingAds = false;
let adQueue = [];
const player = document.getElementById('player');

function refresh(){
 musicList.innerHTML = music.map((m,i)=>`<div class='list-item'>${i+1}. ${m.name}</div>`).join('');
 adList.innerHTML = ads.map((a,i)=>`<div class='list-item'>${i+1}. ${a.name}</div>`).join('');
 adCount.innerText = ads.length;
 interval.value = interval;
 chain.value = chain;
}

function uploadMusic(){
 const files = musicUpload.files;
 for(let f of files){ music.push({name:f.name,url:URL.createObjectURL(f)}); }
 localStorage.setItem('radio_music',JSON.stringify(music));
 refresh();
}

function uploadAd(){
 const files = adUpload.files;
 for(let f of files){ ads.push({name:f.name,url:URL.createObjectURL(f)}); }
 localStorage.setItem('radio_ads',JSON.stringify(ads));
 refresh();
}

function saveConfig(){
 interval = Number(document.getElementById('interval').value);
 chain = Number(document.getElementById('chain').value);
 localStorage.setItem('radio_interval',interval);
 localStorage.setItem('radio_chain',chain);
 alert("Instellingen opgeslagen!");
}

function startRadio(){ if(!music.length){alert('Geen muziek!');return;} playSong(); }

function playSong(){
 if(playingAds) return;
 if(playCount>=interval){ playAds(); return; }
 player.src = music[index].url;
 player.play();
}

function playAds(){
 playingAds = true;
 adQueue = [];
 for(let i=0;i<chain;i++){
  let r = ads[Math.floor(Math.random()*ads.length)];
  if(r) adQueue.push(r.url);
 }
 let first = adQueue.shift();
 if(first){ player.src = first; player.play(); }
}

player.onended = ()=>{
 if(playingAds){
  if(adQueue.length>0){ player.src = adQueue.shift(); player.play(); }
  else{ playingAds=false; playCount=0; nextSong(); }
 } else {
  playCount++; nextSong();
 }
};

function nextSong(){ index=(index+1)%music.length; playSong(); }
function stopRadio(){ player.pause(); }

refresh();
</script>
</body>
</html>

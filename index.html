<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tamigo-achtig Werkrooster</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4; display:flex; justify-content:center; align-items:center; height:100vh; overflow:hidden; }
.container { width:360px; height:600px; background:white; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.3); overflow:hidden; position:relative; display:flex; flex-direction:column; }
.day-display { flex:1; display:flex; flex-direction:column; align-items:center; padding:20px; transition:transform 0.3s; width:100%; text-align:center; overflow-y:auto; }
.day-display h2 { margin-bottom:15px; }
.shift { width:90%; padding:10px; margin:5px 0; border-radius:5px; color:white; cursor:pointer; }
.shift.work { background:#007bff; }
.shift.off { background:#28a745; }
.shift.vacation { background:#dc3545; }
.arrow { position:absolute; top:50%; transform:translateY(-50%); font-size:2em; cursor:pointer; user-select:none; }
.left { left:10px; }
.right { right:10px; }
#popup, #personnelPopup, #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; }
#overlay { background: rgba(0,0,0,0.5); z-index:500; }
#popup, #personnelPopup { background:#fff; padding:20px; border-radius:10px; width:300px; top:50%; left:50%; transform:translate(-50%,-50%); z-index:1000; box-shadow:0 5px 15px rgba(0,0,0,0.3);}
input, select { width:100%; margin-bottom:10px; padding:5px; }
button { padding:5px 10px; margin-top:5px; }
</style>
</head>
<body>

<div class="container">
    <div class="arrow left" onclick="prevDay()">&#8592;</div>
    <div class="arrow right" onclick="nextDay()">&#8594;</div>
    <div id="dayContainer"></div>
    <button onclick="addShiftPrompt()" style="margin:10px;">Shift Toevoegen</button>
    <button onclick="openPersonnel()">Personeel</button>
</div>

<div id="overlay"></div>

<!-- Shift popup -->
<div id="popup">
    <h3>Shift Toevoegen</h3>
    <label>Begin tijd:</label>
    <input type="time" id="startTime" value="09:00">
    <label>Eind tijd:</label>
    <input type="time" id="endTime" value="17:00">
    <label>Medewerker:</label>
    <select id="selectEmployee"></select>
    <button onclick="saveShift()">Opslaan</button>
    <button onclick="closePopup()">Annuleren</button>
</div>

<!-- Personeel popup -->
<div id="personnelPopup">
    <h3>Personeel</h3>
    <div id="employeeList"></div>
    <button onclick="addEmployeePrompt()">Nieuwe medewerker</button>
    <button onclick="closePersonnel()">Sluiten</button>
</div>

<script>
const days = ["Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"];
let employees = [
    {name:"Jan",age:25,hourly:15,maxHours:40,workedHours:0},
    {name:"Lisa",age:30,hourly:20,maxHours:40,workedHours:0}
];
let scheduleData = {};
days.forEach(day=>scheduleData[day]=[]);

let currentDay=0;
let selectedShift=null;

function renderDay(){
    const container=document.getElementById("dayContainer");
    container.innerHTML="";
    const dayDiv=document.createElement("div");
    dayDiv.classList.add("day-display");
    dayDiv.innerHTML=`<h2>${days[currentDay]}</h2>`;
    scheduleData[days[currentDay]].forEach(shift=>{
        const div=document.createElement("div");
        div.classList.add("shift",shift.type);
        div.innerText=`${shift.start} - ${shift.end}\n${shift.employee}`;
        div.addEventListener("click",()=>editShift(shift));
        dayDiv.appendChild(div);
    });
    container.appendChild(dayDiv);
    calculateHours();
}

// Shift popup
function addShiftPrompt(){
    document.getElementById("overlay").style.display="block";
    document.getElementById("popup").style.display="block";
    const select=document.getElementById("selectEmployee");
    select.innerHTML="";
    employees.forEach(emp=>{
        const option=document.createElement("option");
        option.value=emp.name;
        option.innerText=emp.name;
        select.appendChild(option);
    });
    selectedShift=null;
}

function editShift(shift){
    document.getElementById("overlay").style.display="block";
    document.getElementById("popup").style.display="block";
    document.getElementById("startTime").value=shift.start;
    document.getElementById("endTime").value=shift.end;
    document.getElementById("selectEmployee").value=shift.employee;
    selectedShift=shift;
}

function saveShift(){
    const start=document.getElementById("startTime").value;
    const end=document.getElementById("endTime").value;
    const emp=document.getElementById("selectEmployee").value;
    const type="work";
    if(selectedShift){
        selectedShift.start=start;
        selectedShift.end=end;
        selectedShift.employee=emp;
        selectedShift.type=type;
    } else {
        scheduleData[days[currentDay]].push({start,end,employee:emp,type});
    }
    closePopup();
    renderDay();
}

function closePopup(){
    document.getElementById("overlay").style.display="none";
    document.getElementById("popup").style.display="none";
}

// Swipe
let startX=0;
const containerEl=document.getElementById("dayContainer");
containerEl.addEventListener("touchstart",e=>{startX=e.touches[0].clientX;});
containerEl.addEventListener("touchend",e=>{
    const endX=e.changedTouches[0].clientX;
    if(startX-endX>50) nextDay();
    if(endX-startX>50) prevDay();
});

function nextDay(){ currentDay=(currentDay+1)%7; renderDay();}
function prevDay(){ currentDay=(currentDay+7-1)%7; renderDay();}

// Personnel
function openPersonnel(){
    document.getElementById("overlay").style.display="block";
    document.getElementById("personnelPopup").style.display="block";
    const list=document.getElementById("employeeList");
    list.innerHTML="";
    employees.forEach(emp=>{
        const div=document.createElement("div");
        const worked=sumHours(emp.name);
        div.innerHTML=`<b>${emp.name}</b> - Leeftijd: ${emp.age} - Uurloon: â‚¬${emp.hourly} - Max uren/week: ${emp.maxHours} - Gewerkt: ${worked} - Plus/Min: ${worked-emp.maxHours}`;
        list.appendChild(div);
    });
}

function addEmployeePrompt(){
    const name=prompt("Naam medewerker:");
    const age=parseInt(prompt("Leeftijd:"));
    const hourly=parseFloat(prompt("Uurloon:"));
    const maxHours=parseInt(prompt("Max uren/week:"));
    if(name && !isNaN(age) && !isNaN(hourly) && !isNaN(maxHours)){
        employees.push({name,age,hourly,maxHours,workedHours:0});
        openPersonnel();
    }
}

function closePersonnel(){ document.getElementById("overlay").style.display="none"; document.getElementById("personnelPopup").style.display="none"; }

// Bereken gewerkte uren
function sumHours(name){
    let total=0;
    days.forEach(day=>{
        scheduleData[day].forEach(shift=>{
            if(shift.employee===name){
                const [sh,sm]=shift.start.split(":").map(Number);
                const [eh,em]=shift.end.split(":").map(Number);
                total+= (eh+em/60)-(sh+sm/60);
            }
        });
    });
    return total;
}

function calculateHours(){
    employees.forEach(emp=>emp.workedHours=sumHours(emp.name));
}

// Init
renderDay();
</script>

</body>
</html>

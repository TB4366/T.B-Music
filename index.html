<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tamigo-achtig Werkrooster Uitgebreid</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4; }
h1 { text-align:center; margin:20px 0; }
#controls { text-align:center; margin-bottom:10px; }
#controls button { margin:0 5px; padding:8px 12px; }
.container { display:flex; flex-direction:column; align-items:center; }
.week-view { display:flex; justify-content:center; margin-bottom:10px; overflow-x:auto; }
.day-column { width:150px; background:white; border-radius:10px; padding:10px; margin:5px; box-shadow:0 3px 10px rgba(0,0,0,0.2); flex-shrink:0; }
.day-column h3 { text-align:center; margin-bottom:10px; }
.shift { width:90%; padding:5px; margin:5px 0; border-radius:5px; color:white; cursor:pointer; user-select:none; }
.shift.work { background:#007bff; }
.shift.off { background:#28a745; }
.shift.vacation { background:#dc3545; }
#popup, #personnelPopup, #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; }
#overlay { background: rgba(0,0,0,0.5); z-index:500; }
#popup, #personnelPopup { background:#fff; padding:20px; border-radius:10px; width:300px; top:50%; left:50%; transform:translate(-50%,-50%); z-index:1000; box-shadow:0 5px 15px rgba(0,0,0,0.3);}
input, select { width:100%; margin-bottom:10px; padding:5px; }
.shift.dragging { opacity:0.5; }
</style>
</head>
<body>

<h1>Tamigo-achtig Werkrooster</h1>
<div id="controls">
    <button onclick="addShiftPrompt()">Shift Toevoegen</button>
    <button onclick="openPersonnel()">Personeel</button>
    <button onclick="toggleWeekView()">Weekweergave</button>
</div>

<div class="container" id="container">
    <div class="week-view" id="weekContainer"></div>
</div>

<div id="overlay"></div>

<!-- Shift popup -->
<div id="popup">
    <h3>Shift Toevoegen</h3>
    <label>Begin tijd:</label>
    <input type="time" id="startTime" value="09:00">
    <label>Eind tijd:</label>
    <input type="time" id="endTime" value="17:00">
    <label>Medewerker:</label>
    <select id="selectEmployee"></select>
    <label>Type shift:</label>
    <select id="shiftType">
        <option value="work">Werk</option>
        <option value="off">Vrij</option>
        <option value="vacation">Verlof</option>
    </select>
    <button onclick="saveShift()">Opslaan</button>
    <button onclick="closePopup()">Annuleren</button>
</div>

<!-- Personeel popup -->
<div id="personnelPopup">
    <h3>Personeel</h3>
    <div id="employeeList"></div>
    <button onclick="addEmployeePrompt()">Nieuwe medewerker</button>
    <button onclick="closePersonnel()">Sluiten</button>
</div>

<script>
const days=["Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"];
let employees=[
    {name:"Jan",age:25,hourly:15,maxHours:40,workedHours:0},
    {name:"Lisa",age:30,hourly:20,maxHours:40,workedHours:0}
];
let scheduleData={}; // day -> array of shifts
days.forEach(day=>scheduleData[day]=[]);
let selectedShift=null;
let weekView=false;

function renderWeek(){
    const container=document.getElementById("weekContainer");
    container.innerHTML="";
    days.forEach(day=>{
        const col=document.createElement("div");
        col.classList.add("day-column");
        col.innerHTML=`<h3>${day}</h3>`;
        scheduleData[day].forEach(shift=>{
            const div=document.createElement("div");
            div.classList.add("shift",shift.type);
            div.draggable=true;
            div.innerText=`${shift.start} - ${shift.end}\n${shift.employee}`;
            div.addEventListener("click",()=>editShift(shift));
            div.addEventListener("dragstart",e=>{ e.dataTransfer.setData("text", JSON.stringify(shift)); div.classList.add("dragging"); });
            div.addEventListener("dragend",e=>{ div.classList.remove("dragging"); });
            col.appendChild(div);
        });
        col.addEventListener("dragover",e=>e.preventDefault());
        col.addEventListener("drop",e=>{
            e.preventDefault();
            const shiftData=JSON.parse(e.dataTransfer.getData("text"));
            // Verplaats naar deze dag
            scheduleData[day].push({...shiftData});
            // Verwijder uit origineel
            const origDay=days.find(d=>scheduleData[d].includes(shiftData));
            if(origDay) scheduleData[origDay]=scheduleData[origDay].filter(s=>s!==shiftData);
            renderWeek();
        });
        container.appendChild(col);
    });
    calculateHours();
}

// Shift popup
function addShiftPrompt(){
    document.getElementById("overlay").style.display="block";
    document.getElementById("popup").style.display="block";
    const select=document.getElementById("selectEmployee");
    select.innerHTML="";
    employees.forEach(emp=>{
        const option=document.createElement("option");
        option.value=emp.name;
        option.innerText=emp.name;
        select.appendChild(option);
    });
    selectedShift=null;
}

function editShift(shift){
    document.getElementById("overlay").style.display="block";
    document.getElementById("popup").style.display="block";
    document.getElementById("startTime").value=shift.start;
    document.getElementById("endTime").value=shift.end;
    document.getElementById("selectEmployee").value=shift.employee;
    document.getElementById("shiftType").value=shift.type;
    selectedShift=shift;
}

function saveShift(){
    const start=document.getElementById("startTime").value;
    const end=document.getElementById("endTime").value;
    const emp=document.getElementById("selectEmployee").value;
    const type=document.getElementById("shiftType").value;
    if(selectedShift){
        selectedShift.start=start;
        selectedShift.end=end;
        selectedShift.employee=emp;
        selectedShift.type=type;
    } else {
        // Voeg toe aan eerste dag of huidige dag
        const day=weekView?days[0]:days[0];
        scheduleData[day].push({start,end,employee:emp,type});
    }
    closePopup();
    renderWeek();
}

function closePopup(){ document.getElementById("overlay").style.display="none"; document.getElementById("popup").style.display="none"; }

// Personnel
function openPersonnel(){
    document.getElementById("overlay").style.display="block";
    document.getElementById("personnelPopup").style.display="block";
    const list=document.getElementById("employeeList");
    list.innerHTML="";
    employees.forEach(emp=>{
        const worked=sumHours(emp.name);
        const div=document.createElement("div");
        div.innerHTML=`<b>${emp.name}</b> - Leeftijd: ${emp.age} - Uurloon: â‚¬${emp.hourly} - Max uren/week: ${emp.maxHours} - Gewerkt: ${worked} - Plus/Min: ${worked-emp.maxHours}`;
        list.appendChild(div);
    });
}

function addEmployeePrompt(){
    const name=prompt("Naam medewerker:");
    const age=parseInt(prompt("Leeftijd:"));
    const hourly=parseFloat(prompt("Uurloon:"));
    const maxHours=parseInt(prompt("Max uren/week:"));
    if(name && !isNaN(age) && !isNaN(hourly) && !isNaN(maxHours)){
        employees.push({name,age,hourly,maxHours,workedHours:0});
        openPersonnel();
    }
}

function closePersonnel(){ document.getElementById("overlay").style.display="none"; document.getElementById("personnelPopup").style.display="none"; }

// Bereken gewerkte uren
function sumHours(name){
    let total=0;
    days.forEach(day=>{
        scheduleData[day].forEach(shift=>{
            if(shift.employee===name){
                const [sh,sm]=shift.start.split(":").map(Number);
                const [eh,em]=shift.end.split(":").map(Number);
                total+= (eh+em/60)-(sh+sm/60);
            }
        });
    });
    return total;
}

function calculateHours(){
    employees.forEach(emp=>emp.workedHours=sumHours(emp.name));
}

// Toggle week/day view
function toggleWeekView(){ weekView=!weekView; renderWeek(); }

// Init
renderWeek();
</script>

</body>
</html>

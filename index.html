<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Bot Controller</title>
<style>
body {
    background: #0e0e0e;
    color: #eee;
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 500px;
}
h2 {
    margin-bottom: 10px;
}
label {
    display: block;
    margin-top: 10px;
}
input, select, button {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    font-size: 14px;
}
.buttons {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}
button {
    cursor: pointer;
}
button.disabled {
    opacity: 0.4;
    pointer-events: none;
}
#log {
    margin-top: 20px;
    background: #1a1a1a;
    border: 1px solid #333;
    padding: 10px;
    height: 220px;
    overflow-y: auto;
    font-size: 13px;
}
</style>
</head>
<body>

<h2>Bot Setup</h2>

<!-- UID -->
<label>UID (bots volgen deze speler)</label>
<input id="uid" placeholder="Voer UID in">

<!-- Party code -->
<label>Party Code</label>
<input id="partyCode" placeholder="Bijv. ABC123">

<!-- Game mode -->
<label>Game Mode</label>
<select id="gameMode">
    <option value="">-- selecteer --</option>
    <option value="classic">Classic</option>
    <option value="burst">Burst</option>
</select>

<!-- Buttons -->
<div class="buttons">
    <button id="startBtn" class="disabled" onclick="startBots()">Start</button>
    <button onclick="stopBots()">Stop</button>
</div>

<!-- Logs -->
<div id="log"></div>

<script>
/* =========================
   CORE STATE (zoals dylib)
========================= */

let botsRunning = false;
let bot_mode = false;
let botsStartSuccess = false;

/* =========================
   VALIDATION
========================= */

function canStartBots() {
    const uid = document.getElementById("uid").value.trim();
    const party = document.getElementById("partyCode").value.trim();
    const mode = document.getElementById("gameMode").value;

    return (
        uid !== "" &&
        party !== "" &&
        mode !== "" &&
        !botsRunning
    );
}

/* =========================
   UI ENABLE/DISABLE
========================= */

["uid", "partyCode", "gameMode"].forEach(id => {
    document.getElementById(id).addEventListener("input", updateStartButton);
    document.getElementById(id).addEventListener("change", updateStartButton);
});

function updateStartButton() {
    const btn = document.getElementById("startBtn");
    if (canStartBots()) {
        btn.classList.remove("disabled");
    } else {
        btn.classList.add("disabled");
    }
}

/* =========================
   BOT MODE HANDLER
========================= */

function handleBotModeChange(enabled) {
    bot_mode = enabled;
}

/* =========================
   START BOTS
========================= */

function startBots() {
    if (!canStartBots()) {
        log("Kan bots niet starten: gegevens ontbreken");
        return;
    }

    botsRunning = true;
    bot_mode = true;
    botsStartSuccess = true;

    const uid = document.getElementById("uid").value.trim();
    const party = document.getElementById("partyCode").value.trim();
    const mode = document.getElementById("gameMode").value;

    log("Start Bots");
    log("UID volgen: " + uid);
    log("Party code: " + party);
    log("Game mode: " + mode);

    bottingLoop(uid, mode);
}

/* =========================
   STOP BOTS
========================= */

function stopBots() {
    if (!botsRunning) return;

    botsRunning = false;
    bot_mode = false;
    botsStartSuccess = false;

    log("Bots stopped");
}

/* =========================
   BOT LOOP (volgt UID)
========================= */

function bottingLoop(uid, mode) {
    if (!botsRunning) return;

    log("Botting â†’ volgen UID " + uid + " (" + mode + ")");

    setTimeout(() => bottingLoop(uid, mode), 1000);
}

/* =========================
   LOG SYSTEM
========================= */

function log(message) {
    const logDiv = document.getElementById("log");
    logDiv.innerHTML +=
        `[${new Date().toLocaleTimeString()}] ${message}<br>`;
    logDiv.scrollTop = logDiv.scrollHeight;
}
</script>

</body>
</html>
